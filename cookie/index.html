<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>2.ip6.arpa Tomfoolery | Cookie</title>
    <link rel="stylesheet" href="style.css">

    <meta name="description" content="Demo showing how gaps in the Public Suffix List allow globally accessible cookies on ip6.arpa domains.">
    <meta name="author" content="elliott.diy">

    <meta property="og:title" content="2.ip6.arpa Tomfoolery | Cookie Demo">
    <meta property="og:description" content="A small demo highlighting cookie scoping quirks in ip6.arpa domains.">
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://cookie.c.e.0.b.0.7.4.0.1.0.0.2.ip6.arpa/">
    <meta property="og:image" content="https://cdn.dashnet.org/cookieclicker/img/perfectCookie.png">

    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="2.ip6.arpa Tomfoolery | Cookie Demo">
    <meta name="twitter:description" content="A fun demo showing how cookies can be scoped globally under ip6.arpa.">
    <meta name="twitter:image" content="https://cdn.dashnet.org/cookieclicker/img/perfectCookie.png">

</head>
<body>
<h1>cookie.c.e.0.b.0.7.4.0.1.0.0.2.ip6.arpa</h1>
<p class="subtext">A simple demo showing how gaps in the Public Suffix List allow globally accessible cookies on ip6.arpa domains.</p>

<img src="https://cdn.dashnet.org/cookieclicker/img/perfectCookie.png" alt="Seal">

<div class="buttons">
    <button onclick="setCookie()">Set Cookie</button>
</div>

<pre id="log">Waiting to set cookie...</pre>

<script>
    function setCookie() {
        const v = crypto.randomUUID();
        document.cookie = `demo=${v}; Domain=2.ip6.arpa; Path=/; Secure; SameSite=Lax; Max-Age=600`;
        document.getElementById('log').innerHTML = 'Setting cookie: ' + document.cookie;
        document.getElementById("log").innerHTML += '\nCookie set! Go check out another ip6.arpa site to see if it can read the cookie <a href="https://monster.9.4.8.e.0.7.4.0.1.0.0.2.ip6.arpa" target="_blank">here</a>.';    }
</script>

<div class="footer">
    This demo highlights an oddity in how the Public Suffix List treats <code>ip6.arpa</code>.<br />
    Since <code>2.ip6.arpa</code> is the only publicly routed reverse zone, cookies scoped here are effectively
    global, something normally blocked on TLDs like <code>.com</code>.<br />
    In practice this isn’t a security issue, since nobody sane runs normal websites directly on
    <code>.ip6.arpa</code>.<br /><br />
    More info: <a href="https://elliott.diy/blog/arpa" target="_blank">elliott.diy/blog/arpa</a> •
    <a href="https://github.com/elliott-diy" target="_blank">GitHub</a> •
    <a href="https://9.4.8.e.0.7.4.0.1.0.0.2.ip6.arpa/" target="_blank">lemonyte.com</a>
    <br /><br />
</div>



</body>
</html>
